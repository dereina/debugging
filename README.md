# MSVC Visual Studio Compilers

Open the Developer Shell for Visual Studio and open vscode from there with ***code***. Then you can use Visual Studio tools.
    
    C:/"Program Files/Microsoft Visual Studio"/2022/Community/VC/Auxiliary/Build/vcvars64.bat

Alternatively you can call

    C:/"Program Files/Microsoft Visual Studio"/2022/Community/VC/Auxiliary/Build/vcvars64.bat

Before commands.


## MSVC Configuration

*Sample Task*

    {
        "type": "shell",
        "label": "C/C++: msvc build active file",
        "command": "C:/\"Program Files/Microsoft Visual Studio\"/2022/Community/VC/Auxiliary/Build/vcvars64.bat && cl.exe",
        "args": [
            "/Zi",
            "/EHsc",
            "/Fe:",
            "${fileDirname}\\${fileBasenameNoExtension}.exe",
            "${file}"
        ],
        "options": {
            "cwd": "${fileDirname}"
        },
        "problemMatcher": ["$msCompile"],
        "group": {
            "kind": "build",
            "isDefault": true
        },
        "detail": "Task generated by Debugger."
    }

*Sample Launch Configuration*

    {
      "name": "msvc - Build and debug active file(No Meson)",
      "type": "cppvsdbg",
      "request": "launch",
      "program": "${fileDirname}\\${fileBasenameNoExtension}.exe",
      // There I have got error Property keys must be doublequotedjsonc
      "args": [],
      "stopAtEntry": true,
      "cwd": "${workspaceFolder}",
      "environment": [],
      "console": "integratedTerminal",
      "preLaunchTask": "C/C++: msvc build active file"
    }

## Meson Configuration

Note that for name ***builddir*** the ***meson-vscode.env*** is automatically generated. Use ***meson devenv*** to create it

*Sample Task*

    {
        "label": "Meson: Build all targets",
        "type": "shell",
        "command": "C:/\"Program Files/Microsoft Visual Studio\"/2022/Community/VC/Auxiliary/Build/vcvars64.bat && meson setup --reconfigure --debug builddir && cd builddir && ninja",
        "problemMatcher": []
    }

*Sample Launch Configuration*

    {
      "name": "Build and debug",
      "request": "launch",
      "type": "cppvsdbg", //gdb for Visual Studio
      "program": "${workspaceFolder}/${config:mesonbuild.buildFolder}/demo.exe",
      "console": "integratedTerminal",
      "envFile": "${workspaceFolder}/${config:mesonbuild.buildFolder}/meson-vscode.env",
      "environment": [ //variables d'entorn
        {
          "name": "GST_DEBUG",
          "value": "*:2,flu*:6"
        },
        {
          "name": "GST_PLUGIN_PATH",
          "value": "path to plugins"
        },
        {
          "name": "GST_DEBUG_COLOR_MODE", //avoids simbols to color text in some editors...
          "value": "off"
        },
        {
          "name": "GST_DEBUG_FILE",
          "value": "gstreamer_debug.log"
        },
        {
          "name": "GST_DEBUG_DUMP_DOT_DIR", //graphviz to visualize
          "value": "${workspaceRoot}"
        },
      ],
      "stopAtEntry": false,
      "cwd": "${workspaceRoot}",
      "preLaunchTask": "Meson: Build all targets",
      "symbolOptions": {
        "searchPaths": [
          "${workspaceFolder}/${config:mesonbuild.buildFolder}",
        ],
        "searchMicrosoftSymbolServer": true,
        "cachePath": "${workspaceFolder}\\${config:mesonbuild.buildFolder}\\vscode-symbols-cache",
        "moduleFilter": {
          "mode": "loadAllButExcluded",
          "excludedModules": []
        }
      }
    }

# MSYS2 Compilers

Download the MSYS2 installer that matches your platform and follow the installation instructions.
Install the Toolchain, GTK4 and other needed dependencies. Open a MSYS2 shell, and run:

    pacman -Syu
    pacman -S tar make
    pacman -S mingw-w64-x86_64-toolchain
    pacman -S mingw-w64-i686-toolchain

    pacman -S mingw-w64-x86_64-gtk4

If you want to develop with GTK3, run:
    
    pacman -S mingw-w64-x86_64-gtk3

Set the environment 

    set PATH=%PATH%;C:\\msys64\\mingw64\\bin

Alternatively you can call it befora commands.

## MSYS2 Configuration

*Sample Task*

    {
        "type": "cppbuild",
        "label": "C/C++: g++.exe build active file",
        "command": "C:\\msys64\\mingw64\\bin\\g++.exe",
        "args": [
            "-fdiagnostics-color=always",
            "-g3", //maximum debugging information
            "-Wall",
            "${file}",
            "-o",
            "${fileDirname}\\${fileBasenameNoExtension}mingw64.exe"
        ],
        "options": {
            "cwd": "${fileDirname}"
        },
        "problemMatcher": [
            "$gcc"
        ],
        "group": {
            "kind": "build",
            "isDefault": true
        },
        "detail": "compiler: C:\\msys64\\mingw64\\bin\\g++.exe"
    }

*Sample Launch Configuration*
    
    {
      "name": "g++.exe - Build and debug active file(No Meson)",
      "type": "cppdbg",
      "request": "launch",
      "program": "${fileDirname}\\${fileBasenameNoExtension}mingw64.exe",
      // There I have got error Property keys must be doublequotedjsonc
      "args": [],
      "stopAtEntry": true,
      "cwd": "${workspaceFolder}",
      "environment": [],
      "externalConsole": false,
      "MIMode": "gdb", //lldb
      "miDebuggerPath": "C:\\msys64\\mingw64\\bin\\gdb.exe",
      "setupCommands": [
        {
          "description": "Enable pretty-printing for gdb",
          "text": "-enable-pretty-printing",
          "ignoreFailures": true
        }
      ],
      "preLaunchTask": "C/C++: g++.exe build active file"
    }

## Meson Configuration

Note that for name ***builddir*** the ***meson-vscode.env*** is automatically generated. Use ***meson devenv*** to create it


*Sample Task*

    {
        "label": "Meson: Build all targets msys",
        "type": "shell",
        "command": "set PATH=C:\\msys64\\mingw64\\bin;%PATH% && meson setup --reconfigure --debug builddirmsys && cd builddirmsys && ninja && meson devenv -C . --dump-format vscode --dump meson-vscode.env",
        "detail": "compiler: C:\\msys64\\mingw64\\bin\\gcc.exe",
        "problemMatcher": []
    }

*Sample Launch Configuration*
    
    {
      "name": "Build and debug msys",
      "request": "launch",
      "type": "cppdbg", //gdb for linux
      "program": "${workspaceFolder}/builddirmsys/demo.exe",
      "envFile": "${workspaceFolder}/builddirmsys/meson-vscode.env",
      "environment": [ //variables d'entorn
        {
          "name": "GST_DEBUG",
          "value": "*:2,flu*:6"
        },
        {
          "name": "GST_PLUGIN_PATH",
          "value": "path to plugins"
        },
        {
          "name": "GST_DEBUG_COLOR_MODE", //avoids simbols to color text in some editors...
          "value": "off"
        },
        {
          "name": "GST_DEBUG_FILE",
          "value": "gstreamer_debug.log"
        },
        {
          "name": "GST_DEBUG_DUMP_DOT_DIR", //graphviz to visualize
          "value": "${workspaceRoot}"
        },
      ],
      "stopAtEntry": false,
      "cwd": "${workspaceRoot}",
      "preLaunchTask": "Meson: Build all targets msys",
      "symbolLoadInfo": {
        "searchPaths": [
          "${workspaceFolder}/builddirmsys",
        ],
        "searchMicrosoftSymbolServer": true,
        "cachePath": "${workspaceFolder}\\builddirmsys\\vscode-symbols-cache",
        "moduleFilter": {
          "mode": "loadAllButExcluded",
          "excludedModules": []
        }
      }
    }

Launch the correct Configuration for the environment being used.
A PreLaunchTask is set for building.
